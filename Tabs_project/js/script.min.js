"use strict";window.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll(".tabheader__item"),e=document.querySelectorAll(".tabcontent"),s=document.querySelector(".tabheader__items");function n(){e.forEach(t=>{t.classList.add("hide"),t.classList.remove("show","fade")}),t.forEach(t=>{t.classList.remove("tabheader__item_active")})}function o(s=0){e[s].classList.add("show","fade"),e[s].classList.remove("hide"),t[s].classList.add("tabheader__item_active")}n(),o(),s.addEventListener("click",e=>{const s=e.target;s&&s.classList.contains("tabheader__item")&&t.forEach((t,e)=>{s==t&&(n(),o(e))})});!function(t,e){const s=new Date(e),n=document.querySelector(t),o=("0"+s.getDate()).slice(-2),c={0:"января",1:"февраля",2:"марта",3:"апреля",4:"мая",5:"июня",6:"июля",7:"августа",8:"сентября",9:"октября",10:"ноября",11:"декабря"}[s.getMonth()],a=document.createTextNode((s-new Date>0?"Акция закончится ":"Акция закончилась ")+`${o} ${c} в 00: 00`);n.lastChild.remove(),n.append(a)}(".promotion__descr","2021-08-06"),function(t,e){const s=document.querySelector(t),n=s.querySelector("#days"),o=s.querySelector("#hours"),c=s.querySelector("#minutes"),a=s.querySelector("#seconds"),i=setInterval(r,1e3);function r(){const t=function(t){const e=Date.parse(t)-Date.parse(new Date);return e>0?{total:e,days:Math.floor(e/864e5),hours:Math.floor(e/36e5%24),minutes:Math.floor(e/1e3/60%60),seconds:Math.floor(e/1e3%60)}:{total:e,days:0,hours:0,minutes:0,seconds:0}}(e);n.innerHTML=("0"+t.days).slice(-2),o.innerHTML=("0"+t.hours).slice(-2),c.innerHTML=("0"+t.minutes).slice(-2),a.innerHTML=("0"+t.seconds).slice(-2),t.total<=0&&clearInterval(i)}r()}(".timer","2021-08-06");const c=document.querySelectorAll("[data-modal]"),a=document.querySelector(".modal"),i=()=>{a.classList.add("show"),a.classList.remove("hide"),document.body.style.overflow="hidden",clearTimeout(l)},r=()=>{a.classList.remove("show"),a.classList.add("hide"),document.body.style.overflow=""},d=()=>{window.pageYOffset+document.documentElement.clientHeight>=document.documentElement.scrollHeight&&(i(),window.removeEventListener("scroll",d))};c.forEach(t=>{t.addEventListener("click",i)}),a.addEventListener("click",t=>{t.target!==a&&""!=t.target.getAttribute("data-close")||r()}),document.addEventListener("keydown",t=>{"Escape"===t.code&&a.classList.contains("show")&&r()});const l=setTimeout(i,5e4);window.addEventListener("scroll",d);class m{constructor(t,e,s,n,o,c,...a){this.src=t,this.alt=e,this.subtitle=s,this.descr=n,this.price=o,this.classes=a,this.parent=document.querySelector(c),this.transfer=27,this.changeToUAH()}changeToUAH(){this.price*=this.transfer}render(){const t=document.createElement("div");this.classes.length?this.classes.forEach(e=>t.classList.add(e)):(this.element="menu__item",t.classList.add(this.element)),t.innerHTML=`\n\t\t\t\t\t\t<img src=${this.src} alt=${this.alt}>\n\t\t\t\t\t\t<h3 class="menu__item-subtitle">${this.subtitle}</h3>\n\t\t\t\t\t\t<div class="menu__item-descr">${this.descr}</div>\n\t\t\t\t\t\t<div class="menu__item-divider"></div>\n\t\t\t\t\t\t<div class="menu__item-price">\n\t\t\t\t\t\t\t<div class="menu__item-cost">Цена:</div>\n\t\t\t\t\t\t\t<div class="menu__item-total"><span>${this.price}</span> грн/день</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t `,this.parent.append(t)}}(async t=>{const e=await fetch(t);if(!e.ok)throw new Error(`Could not fetch ${t}, status ${e.status}`);return await e.json()})("http://localhost:3000/menu").then(t=>{t.forEach(({img:t,altimg:e,title:s,descr:n,price:o})=>{new m(t,e,s,n,o,".menu .container").render()})});const u=document.querySelectorAll("form"),h={loading:"img/form/spinner.svg",success:"Спасибо! Скоро мы с вами свяжемся",failure:"Что-то пошло не так....."};u.forEach(t=>{var e;(e=t).addEventListener("submit",t=>{t.preventDefault();const s=document.createElement("img");s.src=h.loading,s.style.cssText="\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\tmargin: 0 auto;\n\t\t\t\t\t",e.insertAdjacentElement("afterend",s),e.insertAdjacentElement("afterend",s);const n=new FormData(e);(async(t,e)=>{const s=await fetch(t,{method:"POST",headers:{"Content-type":"application/json"},body:e});return await s.json()})("http://localhost:3000/requests",JSON.stringify(Object.fromEntries(n.entries()))).then(t=>{console.log(t),v(h.success),s.remove()}).catch(()=>{v(h.failure)}).finally(()=>{e.reset()})})});function v(t){const e=document.querySelector(".modal__dialog");e.classList.add("hide"),i();const s=document.createElement("div");s.classList.add("modal__dialog"),s.innerHTML=`\n\t\t\t\t<div class="modal__content">\n\t\t\t\t\t<div data-close class="modal__close">&times;</div>\n\t\t\t\t\t<div class="modal__title">${t}</div>\n\t\t\t\t</div>\n\t\t\t\t`,document.querySelector(".modal").append(s),setTimeout(()=>{s.remove(),e.classList.add("show"),e.classList.remove("hide"),r()},4e4)}const f=document.querySelectorAll(".offer__slide"),_=document.querySelector(".offer__slider-prev"),L=document.querySelector(".offer__slider-next"),y=document.querySelector("#total"),w=document.querySelector("#current"),p=(t,e)=>{t.textContent=e<10?"0"+e:""+e};let g=1;p(y,f.length);const E=t=>{var e;t<1&&(g=f.length),t>f.length&&(g=1),f.forEach(t=>{return(e=t).classList.add("hide"),void e.classList.remove("show","fade");var e}),(e=f[g-1]).classList.remove("hide"),e.classList.add("show","fade"),p(w,g)},S=t=>{E(g+=t)};E(g),_.addEventListener("click",()=>S(-1)),L.addEventListener("click",()=>S(1))});